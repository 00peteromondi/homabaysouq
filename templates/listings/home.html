{% extends 'base.html' %}
{% load static custom_filters %}
{% load crispy_forms_tags %}
{% load humanize %}

{% block title %}Home - Souq Marketplace{% endblock %}

{% block extra_css %}
<style>
    :root {
        --vibrant-pink: #ec4899;
        --vibrant-purple: #8b5cf6;
        --vibrant-blue: #3b82f6;
        --vibrant-teal: #06b6d4;
        --vibrant-green: #10b981;
        --vibrant-yellow: #f59e0b;
        --vibrant-orange: #f97316;
        --vibrant-red: #ef4444;
        --vibrant-indigo: #6366f1;
        --vibrant-cyan: #22d3ee;
        --vibrant-lime: #84cc16;
        --vibrant-amber: #fbbf24;
        --vibrant-rose: #f43f5e;
        --vibrant-emerald: #34d399;
        --vibrant-violet: #a78bfa;
        --vibrant-fuchsia: #d946ef;
    }

    body {
        font-family: 'Inter', 'Figtree', sans-serif;
    }

    h1, h2, h3, h4, h5, h6, .hero-title, .section-title, .category-title {
        font-family: 'Poppins', sans-serif;
        font-weight: 700;
    }

    .bg-elements {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -2;
        pointer-events: none;
        overflow: hidden;
    }
    
    .bg-element {
        position: absolute;
        opacity: 0.08;
        animation: float 20s infinite ease-in-out;
        filter: blur(2px);
        border-radius: 50%;
    }
    
    .bg-element-1 {
        width: 120px;
        height: 120px;
        background: var(--vibrant-pink);
        top: 10%;
        left: 5%;
        animation-delay: 0s;
    }
    
    .bg-element-2 {
        width: 100px;
        height: 100px;
        background: var(--vibrant-purple);
        top: 20%;
        right: 8%;
        animation-delay: 3s;
    }
    
    .bg-element-3 {
        width: 150px;
        height: 150px;
        background: var(--vibrant-blue);
        bottom: 15%;
        left: 10%;
        animation-delay: 6s;
    }
    
    .bg-element-4 {
        width: 80px;
        height: 80px;
        background: var(--vibrant-teal);
        top: 30%;
        right: 15%;
        animation-delay: 9s;
    }
    
    .bg-element-5 {
        width: 130px;
        height: 130px;
        background: var(--vibrant-green);
        bottom: 25%;
        right: 8%;
        animation-delay: 12s;
    }
    
    @keyframes float {
        0%, 100% { transform: translateY(0) rotate(0deg) scale(1); }
        25% { transform: translateY(-20px) rotate(5deg) scale(1.05); }
        50% { transform: translateY(10px) rotate(-3deg) scale(0.95); }
        75% { transform: translateY(-15px) rotate(2deg) scale(1.02); }
    }

    .hero-carousel {
        position: relative;
        height: 600px;
        overflow: hidden;
        border-radius: 0 0 2.5rem 2.5rem;
        margin: 0 -1rem 4rem;
        box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
    }
    
    .carousel-slide {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        opacity: 0;
        transition: opacity 1.2s cubic-bezier(0.4, 0, 0.2, 1);
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        padding: 3rem;
    }
    
    .carousel-slide.active {
        opacity: 1;
    }
    
    .slide-1 {
        background: linear-gradient(135deg, 
            rgba(236, 72, 153, 0.9) 0%, 
            rgba(139, 92, 246, 0.9) 100%),
            url('https://images.unsplash.com/photo-1563013546-7e58a670b5c9?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80');
        background-size: cover;
        background-position: center;
    }
    
    .slide-2 {
        background: linear-gradient(135deg, 
            rgba(245, 158, 11, 0.9) 0%, 
            rgba(249, 115, 22, 0.9) 100%),
            url('https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80');
        background-size: cover;
        background-position: center;
    }
    
    .slide-3 {
        background: linear-gradient(135deg, 
            rgba(16, 185, 129, 0.9) 0%, 
            rgba(6, 182, 212, 0.9) 100%),
            url('https://images.unsplash.com/photo-1560472354-b33ff0c44a43?ixlib=rb-4.0.3&auto=format&fit=crop&w=2069&q=80');
        background-size: cover;
        background-position: center;
    }

    .slide-4 {
        background: linear-gradient(135deg, 
            rgba(99, 102, 241, 0.9) 0%, 
            rgba(139, 92, 246, 0.9) 100%),
            url('https://images.unsplash.com/photo-1556742044-3f034b6dac99?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80');
        background-size: cover;
        background-position: center;
    }

    .slide-5 {
        background: linear-gradient(135deg, 
            rgba(239, 68, 68, 0.9) 0%, 
            rgba(249, 115, 22, 0.9) 100%),
            url('https://images.unsplash.com/photo-1563013546-7e58a670b5c9?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80');
        background-size: cover;
        background-position: center;
    }

    .slide-6 {
        background: linear-gradient(135deg, 
            rgba(6, 182, 212, 0.9) 0%, 
            rgba(59, 130, 246, 0.9) 100%),
            url('https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80');
        background-size: cover;
        background-position: center;
    }
    
    .carousel-content {
        max-width: 900px;
        color: white;
        text-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
    }
    
    .carousel-content h1 {
        font-size: 4rem;
        font-weight: 800;
        margin-bottom: 1.5rem;
        animation: slideInUp 1s ease-out;
        font-family: 'Poppins', sans-serif;
        background: linear-gradient(135deg, #ffffff 0%, #f0f4ff 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }
    
    .carousel-content p {
        font-size: 1.5rem;
        margin-bottom: 2.5rem;
        animation: slideInUp 1s ease-out 0.3s both;
        font-family: 'Inter', sans-serif;
        font-weight: 500;
        opacity: 0.95;
    }
    
    .carousel-buttons {
        animation: slideInUp 1s ease-out 0.6s both;
        display: flex;
        gap: 1.5rem;
        justify-content: center;
        flex-wrap: wrap;
    }
    
    .hero-btn {
        padding: 1.2rem 2.5rem;
        border-radius: 50px;
        font-weight: 700;
        font-size: 1.1rem;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 0.8rem;
        position: relative;
        overflow: hidden;
        border: none;
        cursor: pointer;
        font-family: 'Inter', sans-serif;
    }
    
    .hero-btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
        transition: left 0.6s;
    }
    
    .hero-btn:hover::before {
        left: 100%;
    }
    
    .hero-btn-primary {
        background: linear-gradient(135deg, var(--vibrant-blue), var(--vibrant-purple));
        color: white;
        box-shadow: 0 10px 30px rgba(59, 130, 246, 0.4);
    }
    
    .hero-btn-primary:hover {
        transform: translateY(-5px) scale(1.05);
        box-shadow: 0 15px 40px rgba(59, 130, 246, 0.6);
        color: white;
        text-decoration: none;
    }
    
    .hero-btn-secondary {
        background: rgba(255, 255, 255, 0.2);
        color: white;
        border: 2px solid rgba(255, 255, 255, 0.3);
        backdrop-filter: blur(10px);
    }
    
    .hero-btn-secondary:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: translateY(-5px) scale(1.05);
        box-shadow: 0 15px 40px rgba(255, 255, 255, 0.2);
        color: white;
        text-decoration: none;
    }
    
    .carousel-dots {
        position: absolute;
        bottom: 30px;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        gap: 12px;
    }
    
    .carousel-dot {
        width: 14px;
        height: 14px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.5);
        cursor: pointer;
        transition: all 0.4s ease;
        border: 2px solid transparent;
    }
    
    .carousel-dot.active {
        background: white;
        transform: scale(1.3);
        border-color: rgba(255, 255, 255, 0.8);
        box-shadow: 0 0 15px rgba(255, 255, 255, 0.6);
    }
    
    @keyframes slideInUp {
        from {
            opacity: 0;
            transform: translateY(50px) scale(0.95);
        }
        to {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
    }

    .search-section {
        background: var(--navbar-bg);
        border-radius: 2rem;
        padding: 3rem 2rem;
        margin: 0 1rem 4rem;
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
        border: 1px solid var(--border-color);
        position: relative;
        overflow: hidden;
    }
    
    .search-section::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, 
            var(--vibrant-pink), 
            var(--vibrant-purple), 
            var(--vibrant-blue), 
            var(--vibrant-teal));
    }
    
    .search-container {
        max-width: 800px;
        margin: 0 auto;
        position: relative;
    }
    
    .search-input-wrapper {
        position: relative;
        display: flex;
        background: var(--input-bg);
        border-radius: 50px;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
        border: 2px solid transparent;
        transition: all 0.3s ease;
        overflow: hidden;
    }
    
    .search-input-wrapper:focus-within {
        border-color: var(--vibrant-blue);
        box-shadow: 0 12px 40px rgba(59, 130, 246, 0.2);
        transform: translateY(-2px);
    }
    
    .search-input {
        flex: 1;
        border: none;
        background: transparent;
        padding: 1.5rem 1.5rem 1.5rem 3rem;
        font-size: 1.1rem;
        color: var(--text-color);
        font-family: 'Inter', sans-serif;
        outline: none;
    }
    
    .search-input::placeholder {
        color: var(--input-placeholder-color);
        font-weight: 500;
    }
    
    .search-icon {
        position: absolute;
        left: 1.5rem;
        top: 50%;
        transform: translateY(-50%);
        color: var(--vibrant-blue);
        font-size: 1.3rem;
        z-index: 2;
    }
    
    .search-button {
        background: linear-gradient(135deg, var(--vibrant-blue), var(--vibrant-purple));
        border: none;
        color: white;
        padding: 0 2rem;
        cursor: pointer;
        transition: all 0.3s ease;
        font-weight: 600;
        font-family: 'Inter', sans-serif;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }
    
    .search-button:hover {
        background: linear-gradient(135deg, var(--vibrant-purple), var(--vibrant-pink));
        transform: scale(1.05);
    }

    .category-0 { 
        --category-color: var(--vibrant-pink); 
        --category-shadow: rgba(236, 72, 153, 0.4);
        --category-hover-bg: rgba(236, 72, 153, 0.05);
    }
    .category-1 { 
        --category-color: var(--vibrant-purple); 
        --category-shadow: rgba(139, 92, 246, 0.4);
        --category-hover-bg: rgba(139, 92, 246, 0.05);
    }
    .category-2 { 
        --category-color: var(--vibrant-blue); 
        --category-shadow: rgba(59, 130, 246, 0.4);
        --category-hover-bg: rgba(59, 130, 246, 0.05);
    }
    .category-3 { 
        --category-color: var(--vibrant-teal); 
        --category-shadow: rgba(6, 182, 212, 0.4);
        --category-hover-bg: rgba(6, 182, 212, 0.05);
    }
    .category-4 { 
        --category-color: var(--vibrant-green); 
        --category-shadow: rgba(16, 185, 129, 0.4);
        --category-hover-bg: rgba(16, 185, 129, 0.05);
    }
    .category-5 { 
        --category-color: var(--vibrant-yellow); 
        --category-shadow: rgba(245, 158, 11, 0.4);
        --category-hover-bg: rgba(245, 158, 11, 0.05);
    }
    .category-6 { 
        --category-color: var(--vibrant-orange); 
        --category-shadow: rgba(249, 115, 22, 0.4);
        --category-hover-bg: rgba(249, 115, 22, 0.05);
    }
    .category-7 { 
        --category-color: var(--vibrant-red); 
        --category-shadow: rgba(239, 68, 68, 0.4);
        --category-hover-bg: rgba(239, 68, 68, 0.05);
    }
    .category-8 { 
        --category-color: var(--vibrant-indigo); 
        --category-shadow: rgba(99, 102, 241, 0.4);
        --category-hover-bg: rgba(99, 102, 241, 0.05);
    }
    .category-9 { 
        --category-color: var(--vibrant-cyan); 
        --category-shadow: rgba(34, 211, 238, 0.4);
        --category-hover-bg: rgba(34, 211, 238, 0.05);
    }

    .categories-section {
        margin-bottom: 4rem;
    }
    
    .section-header {
        text-align: center;
        margin-bottom: 3rem;
    }
    
    .section-title {
        position: relative;
        display: inline-block;
        font-weight: 800;
        margin-bottom: 1rem;
        color: var(--text-color);
        font-size: 2.5rem;
        font-family: 'Poppins', sans-serif;
    }
    
    .section-title::after {
        content: '';
        position: absolute;
        bottom: -10px;
        left: 50%;
        transform: translateX(-50%);
        width: 60px;
        height: 4px;
        background: linear-gradient(90deg, var(--vibrant-pink), var(--vibrant-purple));
        border-radius: 2px;
    }
    
    .section-subtitle {
        color: var(--text-color);
        opacity: 0.8;
        max-width: 600px;
        margin: 0 auto;
        font-size: 1.2rem;
        font-family: 'Inter', sans-serif;
    }
    
    .categories-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
    }
    
    .category-card {
        background: var(--card-bg);
        border-radius: 1rem;
        padding: 1.5rem;
        text-align: center;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
        border: 1px solid var(--border-color);
        position: relative;
        overflow: hidden;
        cursor: pointer;
        height: 100%;
        display: flex;
        flex-direction: column;
    }
    
    .category-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: var(--category-color);
        transform: scaleX(0);
        transition: transform 0.4s ease;
    }
    
    .category-card:hover {
        transform: translateY(-8px);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        background: var(--category-hover-bg);
    }
    
    .category-card:hover::before {
        transform: scaleX(1);
    }
    
    .category-icon {
        font-size: 2.5rem;
        margin-bottom: 1rem;
        transition: all 0.4s ease;
        color: var(--category-color);
    }
    
    .category-card:hover .category-icon {
        transform: scale(1.2) rotate(5deg);
    }
    
    .category-content {
        flex: 1;
        display: flex;
        flex-direction: column;
    }
    
    .category-card h3 {
        font-size: 1.2rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
        color: var(--text-color);
        font-family: 'Poppins', sans-serif;
        line-height: 1.3;
    }
    
    .category-description {
        font-size: 0.875rem;
        color: var(--text-muted);
        margin-bottom: 1rem;
        line-height: 1.4;
        flex: 1;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
    
    .category-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: auto;
    }
    
    .category-count {
        padding: 0.4rem 0.8rem;
        border-radius: 15px;
        font-size: 0.75rem;
        font-weight: 700;
        background: var(--category-color);
        color: white;
        box-shadow: 0 4px 15px var(--category-shadow);
        transition: all 0.3s ease;
        white-space: nowrap;
    }
    
    .category-card:hover .category-count {
        transform: scale(1.05);
        box-shadow: 0 6px 20px var(--category-shadow);
    }

    /* FIXED: Extra categories display side by side with animation */
    .extra-categories-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1.5rem;
        overflow: hidden;
        max-height: 0;
        transition: max-height 0.5s ease-out;
    }
    
    .extra-categories-container.show {
        max-height: 1500px;
        margin-top: 1.5rem;
    }
    
    .extra-categories-container .category-card {
        opacity: 0;
        transform: translateY(20px);
        transition: opacity 0.5s ease, transform 0.5s ease;
    }
    
    .extra-categories-container.show .category-card {
        opacity: 1;
        transform: translateY(0);
    }
    
    .extra-categories-container.show .category-card:nth-child(1) { transition-delay: 0.05s; }
    .extra-categories-container.show .category-card:nth-child(2) { transition-delay: 0.1s; }
    .extra-categories-container.show .category-card:nth-child(3) { transition-delay: 0.15s; }
    .extra-categories-container.show .category-card:nth-child(4) { transition-delay: 0.2s; }
    .extra-categories-container.show .category-card:nth-child(5) { transition-delay: 0.25s; }
    .extra-categories-container.show .category-card:nth-child(6) { transition-delay: 0.3s; }
    .extra-categories-container.show .category-card:nth-child(7) { transition-delay: 0.35s; }
    .extra-categories-container.show .category-card:nth-child(8) { transition-delay: 0.4s; }
    .extra-categories-container.show .category-card:nth-child(9) { transition-delay: 0.45s; }
    .extra-categories-container.show .category-card:nth-child(10) { transition-delay: 0.5s; }

    .toggle-categories {
        text-align: center;
        margin-top: 3rem;
    }
    
    .toggle-btn {
        background: linear-gradient(135deg, var(--vibrant-purple), var(--vibrant-pink));
        color: white;
        border: none;
        padding: 1rem 2.5rem;
        border-radius: 50px;
        font-weight: 700;
        font-size: 1.1rem;
        cursor: pointer;
        transition: all 0.4s ease;
        box-shadow: 0 8px 25px rgba(139, 92, 246, 0.3);
        font-family: 'Inter', sans-serif;
        display: inline-flex;
        align-items: center;
        gap: 0.8rem;
        position: relative;
        overflow: hidden;
    }
    
    .toggle-btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
        transition: left 0.6s;
    }
    
    .toggle-btn:hover::before {
        left: 100%;
    }
    
    .toggle-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 12px 35px rgba(139, 92, 246, 0.4);
        background: linear-gradient(135deg, var(--vibrant-pink), var(--vibrant-purple));
    }

    .category-items-section {
        margin-bottom: 4rem;
    }
    
    .category-block {
        margin-bottom: 5rem;
    }
    
    .category-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 2.5rem;
        padding-bottom: 1.2rem;
        border-bottom: 2px solid var(--border-color);
    }
    
    .category-title {
        display: flex;
        align-items: center;
        gap: 1.2rem;
        font-size: 2rem;
        font-weight: 800;
        color: var(--text-color);
        font-family: 'Poppins', sans-serif;
    }
    
    .category-title-icon {
        width: 60px;
        height: 60px;
        border-radius: 15px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.8rem;
        color: var(--text-color);
        background: var(--category-color);
        box-shadow: 0 6px 20px var(--category-shadow);
        transition: all 0.3s ease;
    }

    [data-bs-theme="dark"] .category-title-icon {
        color: white;
    }
    
    .category-header:hover .category-title-icon {
        transform: scale(1.1) rotate(5deg);
    }
    
    .view-all-btn {
        background: transparent;
        color: var(--vibrant-blue);
        border: 2px solid var(--vibrant-blue);
        padding: 0.8rem 1.8rem;
        border-radius: 25px;
        font-weight: 700;
        font-size: 1rem;
        cursor: pointer;
        transition: all 0.4s ease;
        font-family: 'Inter', sans-serif;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 0.6rem;
        position: relative;
        overflow: hidden;
    }
    
    .view-all-btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.2), transparent);
        transition: left 0.6s;
    }
    
    .view-all-btn:hover::before {
        left: 100%;
    }
    
    .view-all-btn:hover {
        background: var(--vibrant-blue);
        color: white;
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3);
        text-decoration: none;
    }
    
    .items-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
        gap: 1.8rem;
    }
    
    .item-card {
        background: var(--card-bg);
        border-radius: 1.2rem;
        overflow: hidden;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
        border: 1px solid var(--border-color);
        position: relative;
    }
    
    .item-card:hover {
        transform: translateY(-8px);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
    }
    
    .item-image-container {
        position: relative;
        height: 180px;
        overflow: hidden;
    }
    
    .item-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.6s ease;
    }
    
    .item-card:hover .item-image {
        transform: scale(1.1);
    }
    
    /* FIXED: Badge text color for light/dark themes */
    .item-badge {
        position: absolute;
        top: 12px;
        left: 12px;
        background: var(--category-color);
        padding: 0.4rem 0.8rem;
        border-radius: 15px;
        font-size: 0.75rem;
        font-weight: 700;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: white;
    }
    
    [data-bs-theme="light"] .item-badge {
        color: #333;
    }
    
    .item-favorite-btn {
        position: absolute;
        top: 12px;
        right: 12px;
        background: rgba(255, 255, 255, 0.9);
        border: none;
        border-radius: 50%;
        width: 36px;
        height: 36px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s ease;
        backdrop-filter: blur(10px);
        color: var(--text-muted);
        font-size: 1.1rem;
    }
    
    .item-favorite-btn:hover {
        background: white;
        transform: scale(1.1);
        color: var(--danger-color);
    }
    
    .item-favorite-btn.favorited {
        background: var(--danger-color);
        color: white;
    }
    
    .item-favorite-btn.favorited:hover {
        background: #dc2626;
        color: white;
    }
    
    .item-content {
        padding: 1.5rem;
    }
    
    .item-title {
        font-weight: 700;
        margin-bottom: 0.6rem;
        color: var(--text-color);
        font-size: 1.1rem;
        font-family: 'Inter', sans-serif;
        line-height: 1.4;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
        height: 3rem;
    }
    
    .item-price {
        font-weight: 800;
        color: var(--vibrant-blue);
        font-size: 1.3rem;
        margin-bottom: 1rem;
        font-family: 'Inter', sans-serif;
    }
    
    .item-meta {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.2rem;
    }
    
    .item-location {
        background: var(--tag-bg);
        color: var(--tag-text);
        padding: 0.4rem 0.8rem;
        border-radius: 12px;
        font-size: 0.8rem;
        font-weight: 600;
        font-family: 'Inter', sans-serif;
    }
    
    .item-stock {
        font-size: 0.8rem;
        font-weight: 700;
        padding: 0.3rem 0.7rem;
        border-radius: 10px;
        font-family: 'Inter', sans-serif;
    }
    
    .in-stock {
        background: rgba(16, 185, 129, 0.1);
        color: var(--vibrant-green);
        border: 1px solid rgba(16, 185, 129, 0.2);
    }
    
    .low-stock {
        background: rgba(245, 158, 11, 0.1);
        color: var(--vibrant-yellow);
        border: 1px solid rgba(245, 158, 11, 0.2);
    }
    
    .out-of-stock {
        background: rgba(239, 68, 68, 0.1);
        color: var(--vibrant-red);
        border: 1px solid rgba(239, 68, 68, 0.2);
    }
    
    .item-actions {
        display: flex;
        gap: 0.8rem;
    }
    
    .action-btn {
        flex: 1;
        padding: 0.7rem;
        border: none;
        border-radius: 10px;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 0.85rem;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.4rem;
        text-decoration: none;
        font-family: 'Inter', sans-serif;
    }
    
    .view-btn {
        background: var(--vibrant-blue);
        color: white;
    }
    
    .view-btn:hover {
        background: var(--vibrant-purple);
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(59, 130, 246, 0.4);
        text-decoration: none;
        color: white;
    }
    
    .cart-btn {
        background: transparent;
        color: var(--text-color);
        border: 1px solid var(--border-color);
    }
    
    .cart-btn:hover {
        background: var(--vibrant-green);
        color: white;
        border-color: var(--vibrant-green);
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(16, 185, 129, 0.4);
    }

    .stats-section {
        margin-bottom: 4rem;
        overflow: hidden;
    }
    
    .stats-card {
        background: var(--card-bg);
        border-radius: 2rem;
        padding: 3rem 2rem;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
        border: 1px solid var(--border-color);
        position: relative;
        overflow: hidden;
    }
    
    .stats-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 5px;
        background: linear-gradient(90deg, 
            var(--vibrant-pink), 
            var(--vibrant-purple), 
            var(--vibrant-blue), 
            var(--vibrant-teal));
    }
    
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 2rem;
        overflow-x: auto;
        padding-bottom: 1rem;
        scrollbar-width: thin;
        scrollbar-color: var(--primary-gemini) transparent;
    }
    
    .stats-grid::-webkit-scrollbar {
        height: 6px;
    }
    
    .stats-grid::-webkit-scrollbar-track {
        background: transparent;
        border-radius: 3px;
    }
    
    .stats-grid::-webkit-scrollbar-thumb {
        background: var(--primary-gemini);
        border-radius: 3px;
    }
    
    @media (max-width: 768px) {
        .stats-grid {
            grid-template-columns: repeat(4, 280px);
            gap: 1.5rem;
            scroll-snap-type: x mandatory;
            -webkit-overflow-scrolling: touch;
        }
        
        .stat-item {
            scroll-snap-align: start;
            min-width: 280px;
        }
    }
    
    .stat-item {
        text-align: center;
        padding: 2rem 1.5rem;
        border-radius: 1.5rem;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        background: var(--card-bg);
        border: 1px solid transparent;
        position: relative;
        overflow: hidden;
    }
    
    .stat-item::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: var(--stat-color);
        transform: scaleX(0);
        transition: transform 0.4s ease;
    }
    
    .stat-item:hover {
        transform: translateY(-8px);
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
        border-color: var(--border-color);
    }
    
    .stat-item:hover::before {
        transform: scaleX(1);
    }
    
    .stat-icon {
        font-size: 3rem;
        margin-bottom: 1.5rem;
        color: var(--stat-color);
        transition: all 0.4s ease;
    }
    
    .stat-item:hover .stat-icon {
        transform: scale(1.2) rotate(5deg);
    }
    
    .stat-value {
        font-size: 2.5rem;
        font-weight: 800;
        margin-bottom: 0.8rem;
        color: var(--text-color);
        font-family: 'Poppins', sans-serif;
        background: linear-gradient(135deg, var(--stat-color), var(--stat-color-secondary));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        transition: all 0.4s ease;
    }
    
    .stat-item:hover .stat-value {
        transform: scale(1.1);
    }
    
    .stat-label {
        font-size: 1.1rem;
        color: var(--text-color);
        opacity: 0.8;
        font-weight: 700;
        font-family: 'Inter', sans-serif;
    }
    
    .stat-1 { --stat-color: var(--vibrant-pink); --stat-color-secondary: var(--vibrant-rose); }
    .stat-2 { --stat-color: var(--vibrant-purple); --stat-color-secondary: var(--vibrant-violet); }
    .stat-3 { --stat-color: var(--vibrant-blue); --stat-color-secondary: var(--vibrant-indigo); }
    .stat-4 { --stat-color: var(--vibrant-green); --stat-color-secondary: var(--vibrant-emerald); }

    .sellers-section {
        margin-bottom: 4rem;
    }
    
    .sellers-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 2rem;
    }
    
    .seller-card {
        background: var(--card-bg);
        border-radius: 1.5rem;
        padding: 2.5rem 2rem;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
        border: 1px solid var(--border-color);
        transition: all 0.4s ease;
        text-align: center;
        position: relative;
        overflow: hidden;
    }
    
    .seller-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, var(--vibrant-orange), var(--vibrant-yellow));
        transform: scaleX(0);
        transition: transform 0.4s ease;
    }
    
    .seller-card:hover::before {
        transform: scaleX(1);
    }
    
    .seller-card:hover {
        transform: translateY(-8px);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
    }
    
    .seller-avatar {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        object-fit: cover;
        margin: 0 auto 1.5rem;
        border: 4px solid var(--vibrant-orange);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        transition: all 0.4s ease;
        background: var(--card-bg-hover);
    }
    
    .seller-card:hover .seller-avatar {
        transform: scale(1.1);
        border-color: var(--vibrant-yellow);
    }
    
    .seller-name {
        font-size: 1.4rem;
        font-weight: 800;
        margin-bottom: 0.5rem;
        color: var(--text-color);
        font-family: 'Poppins', sans-serif;
    }
    
    .seller-rating {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
        margin-bottom: 1.5rem;
        color: var(--vibrant-yellow);
        font-size: 1rem;
    }
    
    .seller-stats {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 1rem;
        margin-bottom: 2rem;
    }
    
    .seller-stat {
        text-align: center;
    }
    
    .seller-stat-value {
        font-size: 1.5rem;
        font-weight: 800;
        color: var(--vibrant-blue);
        font-family: 'Poppins', sans-serif;
    }
    
    .seller-stat-label {
        font-size: 0.9rem;
        color: var(--text-color);
        opacity: 0.7;
        font-weight: 700;
        font-family: 'Inter', sans-serif;
    }
    
    .seller-btn {
        background: linear-gradient(135deg, var(--vibrant-orange), var(--vibrant-yellow));
        color: white;
        border: none;
        padding: 0.8rem 2rem;
        border-radius: 25px;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.4s ease;
        font-size: 1rem;
        text-decoration: none;
        display: inline-block;
        font-family: 'Inter', sans-serif;
        position: relative;
        overflow: hidden;
    }
    
    .seller-btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
        transition: left 0.6s;
    }
    
    .seller-btn:hover::before {
        left: 100%;
    }
    
    .seller-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(245, 158, 11, 0.4);
        color: white;
        text-decoration: none;
    }

    .blog-section {
        margin-bottom: 4rem;
    }
    
    .blog-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
        gap: 2rem;
    }
    
    .blog-card {
        background: var(--card-bg);
        border-radius: 1.5rem;
        overflow: hidden;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
        border: 1px solid var(--border-color);
        transition: all 0.4s ease;
        position: relative;
    }
    
    .blog-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, var(--vibrant-teal), var(--vibrant-cyan));
        transform: scaleX(0);
        transition: transform 0.4s ease;
    }
    
    .blog-card:hover::before {
        transform: scaleX(1);
    }
    
    .blog-card:hover {
        transform: translateY(-8px);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
    }
    
    .blog-image {
        height: 200px;
        width: 100%;
        object-fit: cover;
    }
    
    .blog-content {
        padding: 2rem;
    }
    
    .blog-meta {
        display: flex;
        justify-content: space-between;
        margin-bottom: 1rem;
        font-size: 0.9rem;
        color: var(--text-color);
        opacity: 0.7;
        font-family: 'Inter', sans-serif;
    }
    
    .blog-title {
        font-weight: 800;
        margin-bottom: 1rem;
        color: var(--text-color);
        font-size: 1.3rem;
        font-family: 'Poppins', sans-serif;
        line-height: 1.4;
    }
    
    .blog-excerpt {
        color: var(--text-color);
        opacity: 0.8;
        margin-bottom: 1.5rem;
        font-size: 1rem;
        line-height: 1.6;
        font-family: 'Inter', sans-serif;
    }
    
    .blog-btn {
        background: transparent;
        color: var(--vibrant-teal);
        border: 2px solid var(--vibrant-teal);
        padding: 0.7rem 1.5rem;
        border-radius: 25px;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.4s ease;
        font-size: 1rem;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        font-family: 'Inter', sans-serif;
    }
    
    .blog-btn:hover {
        background: var(--vibrant-teal);
        color: white;
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(6, 182, 212, 0.3);
        text-decoration: none;
    }

    .ad-banner {
        border-radius: 2rem;
        padding: 4rem 3rem;
        text-align: center;
        margin: 5rem 0;
        position: relative;
        overflow: hidden;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
    }
    
    .ad-banner::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg, var(--banner-color-1), var(--banner-color-2));
        z-index: 1;
    }
    
    .ad-content {
        position: relative;
        z-index: 2;
        color: white;
        max-width: 800px;
        margin: 0 auto;
    }
    
    .ad-title {
        font-size: 3rem;
        font-weight: 800;
        margin-bottom: 1.5rem;
        text-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        font-family: 'Poppins', sans-serif;
        min-height: 4.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    
    .ad-text {
        font-size: 1.5rem;
        margin-bottom: 2.5rem;
        opacity: 0.9;
        font-family: 'Inter', sans-serif;
        font-weight: 500;
        min-height: 2.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    
    .ad-btn {
        background: rgba(255, 255, 255, 0.2);
        color: white;
        border: 2px solid rgba(255, 255, 255, 0.3);
        padding: 1rem 2.5rem;
        border-radius: 50px;
        font-weight: 700;
        font-size: 1.1rem;
        cursor: pointer;
        transition: all 0.4s ease;
        backdrop-filter: blur(10px);
        font-family: 'Inter', sans-serif;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 0.8rem;
    }
    
    .ad-btn:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: translateY(-3px);
        box-shadow: 0 10px 30px rgba(255, 255, 255, 0.2);
        color: white;
        text-decoration: none;
    }
    
    .banner-1 {
        --banner-color-1: var(--vibrant-pink);
        --banner-color-2: var(--vibrant-purple);
    }
    
    .banner-2 {
        --banner-color-1: var(--vibrant-blue);
        --banner-color-2: var(--vibrant-teal);
    }
    
    .banner-3 {
        --banner-color-1: var(--vibrant-orange);
        --banner-color-2: var(--vibrant-yellow);
    }

    .faq-section {
        margin-bottom: 5rem;
    }
    
    .faq-container {
        max-width: 900px;
        margin: 0 auto;
    }
    
    .faq-item {
        background: var(--card-bg);
        border-radius: 1.5rem;
        margin-bottom: 1.5rem;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
        border: 1px solid var(--border-color);
        overflow: hidden;
        transition: all 0.3s ease;
    }
    
    .faq-item:hover {
        box-shadow: 0 12px 35px rgba(0, 0, 0, 0.12);
    }
    
    .faq-question {
        padding: 2rem 2.5rem;
        font-size: 1.3rem;
        font-weight: 700;
        color: var(--text-color);
        cursor: pointer;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-family: 'Poppins', sans-serif;
        transition: all 0.3s ease;
    }
    
    .faq-question:hover {
        color: var(--vibrant-blue);
    }
    
    .faq-answer {
        padding: 0 2.5rem 2rem;
        color: var(--text-color);
        opacity: 0.8;
        font-size: 1.1rem;
        line-height: 1.6;
        font-family: 'Inter', sans-serif;
        display: none;
    }
    
    .faq-item.active .faq-answer {
        display: block;
        animation: fadeIn 0.5s ease-out;
    }
    
    .faq-icon {
        transition: transform 0.3s ease;
    }
    
    .faq-item.active .faq-icon {
        transform: rotate(180deg);
    }

    .cta-section {
        background: linear-gradient(135deg, var(--vibrant-purple), var(--vibrant-pink), var(--vibrant-blue));
        border-radius: 2.5rem;
        color: white;
        padding: 5rem 3rem;
        text-align: center;
        margin-bottom: 4rem;
        box-shadow: 0 25px 60px rgba(139, 92, 246, 0.3);
        position: relative;
        overflow: hidden;
    }
    
    .cta-content {
        position: relative;
        z-index: 2;
        max-width: 800px;
        margin: 0 auto;
    }
    
    .cta-content h2 {
        font-weight: 800;
        margin-bottom: 1.5rem;
        font-size: 3.2rem;
        font-family: 'Poppins', sans-serif;
        text-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    }
    
    .cta-content p {
        font-size: 1.4rem;
        margin-bottom: 2.5rem;
        opacity: 0.9;
        font-family: 'Inter', sans-serif;
        line-height: 1.6;
    }
    
    .cta-buttons {
        display: flex;
        gap: 1.5rem;
        justify-content: center;
        flex-wrap: wrap;
    }
    
    .cta-btn {
        padding: 1.2rem 2.5rem;
        border-radius: 50px;
        font-weight: 700;
        font-size: 1.1rem;
        transition: all 0.4s ease;
        font-family: 'Inter', sans-serif;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 0.8rem;
        position: relative;
        overflow: hidden;
    }
    
    .cta-btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
        transition: left 0.6s;
    }
    
    .cta-btn:hover::before {
        left: 100%;
    }
    
    .cta-btn-primary {
        background: white;
        color: var(--vibrant-purple);
        box-shadow: 0 10px 30px rgba(255, 255, 255, 0.3);
    }
    
    .cta-btn-primary:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 40px rgba(255, 255, 255, 0.4);
        color: var(--vibrant-purple);
        text-decoration: none;
    }
    
    .cta-btn-secondary {
        background: transparent;
        color: white;
        border: 2px solid white;
    }
    
    .cta-btn-secondary:hover {
        background: white;
        color: var(--vibrant-purple);
        transform: translateY(-5px);
        text-decoration: none;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes textRotate {
        0% { opacity: 0; transform: translateY(20px); }
        20% { opacity: 1; transform: translateY(0); }
        80% { opacity: 1; transform: translateY(0); }
        100% { opacity: 0; transform: translateY(-20px); }
    }

    @media (max-width: 768px) {
        .hero-carousel {
            height: 500px;
        }
        
        .carousel-content h1 {
            font-size: 2.8rem;
        }
        
        .carousel-content p {
            font-size: 1.2rem;
        }
        
        .hero-btn {
            padding: 1rem 2rem;
            font-size: 1rem;
        }
        
        .categories-grid {
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 1rem;
        }
        
        .extra-categories-container {
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 1rem;
        }
        
        .category-header {
            flex-direction: column;
            align-items: flex-start;
            gap: 1rem;
        }
        
        .items-grid {
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 1.2rem;
        }
        
        .stats-grid {
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
        }
        
        .ad-banner {
            padding: 3rem 2rem;
        }
        
        .ad-title {
            font-size: 2.2rem;
            min-height: 3.5rem;
        }
        
        .ad-text {
            font-size: 1.2rem;
            min-height: 2rem;
        }
        
        .faq-question {
            padding: 1.5rem;
            font-size: 1.1rem;
        }
        
        .faq-answer {
            padding: 0 1.5rem 1.5rem;
        }
        
        .cta-content h2 {
            font-size: 2.5rem;
        }
        
        .cta-content p {
            font-size: 1.2rem;
        }
        
        .cta-buttons {
            flex-direction: column;
            align-items: center;
        }
        
        .cta-btn {
            width: 100%;
            max-width: 300px;
            justify-content: center;
        }
    }

    @media (max-width: 576px) {
        .hero-carousel {
            height: 450px;
        }
        
        .carousel-content h1 {
            font-size: 2.2rem;
        }
        
        .search-section {
            padding: 2.5rem 1.5rem;
        }
        
        .section-title {
            font-size: 2rem;
        }
        
        .categories-grid {
            grid-template-columns: repeat(2, 1fr);
        }
        
        .extra-categories-container {
            grid-template-columns: repeat(2, 1fr);
        }
        
        .items-grid {
            grid-template-columns: 1fr;
        }
        
        .stats-grid {
            grid-template-columns: 1fr;
        }
        
        .sellers-grid, .blog-grid {
            grid-template-columns: 1fr;
        }
        
        .category-title {
            font-size: 1.6rem;
        }
        
        .ad-title {
            font-size: 1.8rem;
            min-height: 3rem;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="bg-elements">
    <div class="bg-element bg-element-1"></div>
    <div class="bg-element bg-element-2"></div>
    <div class="bg-element bg-element-3"></div>
    <div class="bg-element bg-element-4"></div>
    <div class="bg-element bg-element-5"></div>
</div>

<div class="hero-carousel">
    <div class="carousel-slide slide-1 active">
        <div class="carousel-content">
            <h1>Discover Amazing Deals</h1>
            <p>Find everything you need from trusted local sellers in your community</p>
            <div class="carousel-buttons">
                <a href="{% url 'all-listings' %}" class="hero-btn hero-btn-primary">
                    <i class="bi bi-bag-check"></i>
                    <span>Start Shopping</span>
                </a>
                {% if not user.is_authenticated %}
                <a href="{% url 'register' %}" class="hero-btn hero-btn-secondary">
                    <i class="bi bi-person-plus"></i>
                    <span>Join Now</span>
                </a>
                {% endif %}
            </div>
        </div>
    </div>
    <div class="carousel-slide slide-2">
        <div class="carousel-content">
            <h1>Sell Your Items Effortlessly</h1>
            <p>Reach thousands of buyers with our secure platform</p>
            <div class="carousel-buttons">
                <a href="{% url 'listing-create' %}" class="hero-btn hero-btn-primary">
                    <i class="bi bi-plus-circle"></i>
                    <span>Start Selling</span>
                </a>
                <a href="{% url 'all-listings' %}" class="hero-btn hero-btn-secondary">
                    <i class="bi bi-grid"></i>
                    <span>Browse Listings</span>
                </a>
            </div>
        </div>
    </div>
    <div class="carousel-slide slide-3">
        <div class="carousel-content">
            <h1>Connect with Your Community</h1>
            <p>Buy and sell directly with people in your neighborhood</p>
            <div class="carousel-buttons">
                {% if user.is_authenticated %}
                <a href="{% url 'listing-create' %}" class="hero-btn hero-btn-primary">
                    <i class="bi bi-megaphone"></i>
                    <span>List an Item</span>
                </a>
                {% else %}
                <a href="{% url 'register' %}" class="hero-btn hero-btn-primary">
                    <i class="bi bi-person-check"></i>
                    <span>Create Account</span>
                </a>
                {% endif %}
                <a href="{% url 'all-listings' %}" class="hero-btn hero-btn-secondary">
                    <i class="bi bi-compass"></i>
                    <span>Explore Marketplace</span>
                </a>
            </div>
        </div>
    </div>
    <div class="carousel-slide slide-4">
        <div class="carousel-content">
            <h1>Secure Transactions</h1>
            <p>Shop with confidence using our escrow protection system</p>
            <div class="carousel-buttons">
                <a href="{% url 'all-listings' %}" class="hero-btn hero-btn-primary">
                    <i class="bi bi-shield-check"></i>
                    <span>Shop Securely</span>
                </a>
                <a href="#" class="hero-btn hero-btn-secondary">
                    <i class="bi bi-info-circle"></i>
                    <span>Learn More</span>
                </a>
            </div>
        </div>
    </div>
    <div class="carousel-slide slide-5">
        <div class="carousel-content">
            <h1>Fast & Free Delivery</h1>
            <p>Enjoy quick delivery options from local sellers</p>
            <div class="carousel-buttons">
                <a href="{% url 'all-listings' %}" class="hero-btn hero-btn-primary">
                    <i class="bi bi-truck"></i>
                    <span>Shop Local</span>
                </a>
                <a href="#" class="hero-btn hero-btn-secondary">
                    <i class="bi bi-geo-alt"></i>
                    <span>Find Sellers Nearby</span>
                </a>
            </div>
        </div>
    </div>
    <div class="carousel-slide slide-6">
        <div class="carousel-content">
            <h1>Quality Guaranteed</h1>
            <p>Verified sellers and quality products you can trust</p>
            <div class="carousel-buttons">
                <a href="{% url 'all-listings' %}" class="hero-btn hero-btn-primary">
                    <i class="bi bi-award"></i>
                    <span>Shop Quality</span>
                </a>
                <a href="#" class="hero-btn hero-btn-secondary">
                    <i class="bi bi-star"></i>
                    <span>Top Rated Sellers</span>
                </a>
            </div>
        </div>
    </div>
    <div class="carousel-dots">
        <div class="carousel-dot active" data-slide="0"></div>
        <div class="carousel-dot" data-slide="1"></div>
        <div class="carousel-dot" data-slide="2"></div>
        <div class="carousel-dot" data-slide="3"></div>
        <div class="carousel-dot" data-slide="4"></div>
        <div class="carousel-dot" data-slide="5"></div>
    </div>
</div>

<section class="search-section">
    <div class="search-container">
        <form method="get" action="{% url 'all-listings' %}" class="search-input-wrapper">
            <i class="bi bi-search search-icon"></i>
            <input type="text" name="q" class="search-input" placeholder="Search for products, brands, and categories..." value="{{ request.GET.q }}">
            <button class="search-button" type="submit">
                <i class="bi bi-search"></i>
                <span>Search</span>
            </button>
        </form>
    </div>
</section>

<section class="container">
    <div class="ad-banner banner-1">
        <div class="ad-content">
            <h2 class="ad-title" id="banner-text-1">Flash Sale! Up to 50% Off</h2>
            <p class="ad-text" id="banner-subtext-1">Limited time offers on electronics and home appliances</p>
            <a href="{% url 'all-listings' %}?sort_by=featured" class="ad-btn">
                <i class="bi bi-lightning"></i>
                <span>Shop Now</span>
            </a>
        </div>
    </div>
</section>

<section class="container categories-section">
    <div class="section-header">
        <h2 class="section-title">Browse Categories</h2>
        <p class="section-subtitle">Explore our wide range of categories to find exactly what you're looking for</p>
    </div>
    
    <div class="categories-grid">
        {% for category in categories|slice:":10" %}
        <a href="{% url 'all-listings' %}?category={{ category.id }}" class="category-card category-{{ forloop.counter0|mod:10 }} text-decoration-none">
            <i class="bi bi-{{ category.icon|default:'grid' }} category-icon"></i>
            <div class="category-content">
                <h3>{{ category.name }}</h3>
                <p class="category-description">{{ category.description|default:"Discover amazing products in this category" }}</p>
                <div class="category-footer">
                    <span class="category-count">
                        {% with listing_count=category.listing_set.count %}
                            {{ listing_count }} item{{ listing_count|pluralize }}
                        {% endwith %}
                    </span>
                </div>
            </div>
        </a>
        {% endfor %}
    </div>
    
    <!-- FIXED: Extra categories container for side-by-side display -->
    <div class="extra-categories-container" id="extra-categories-container">
        {% for category in categories|slice:"10:34" %}
        <a href="{% url 'all-listings' %}?category={{ category.id }}" class="category-card category-{{ forloop.counter0|add:10|mod:10 }} text-decoration-none">
            <i class="bi bi-{{ category.icon|default:'grid' }} category-icon"></i>
            <div class="category-content">
                <h3>{{ category.name }}</h3>
                <p class="category-description">{{ category.description|default:"Explore various products in this category" }}</p>
                <div class="category-footer">
                    <span class="category-count">
                        {% with listing_count=category.listing_set.count %}
                            {{ listing_count }} item{{ listing_count|pluralize }}
                        {% endwith %}
                    </span>
                </div>
            </div>
        </a>
        {% endfor %}
    </div>
    
    <div class="toggle-categories">
        <button class="toggle-btn" id="toggle-categories">
            <i class="bi bi-chevron-down" id="toggle-icon"></i>
            <span id="toggle-text">View More Categories</span>
        </button>
    </div>
</section>

<section class="container">
    <div class="ad-banner banner-2">
        <div class="ad-content">
            <h2 class="ad-title" id="banner-text-2">Free Delivery Available</h2>
            <p class="ad-text" id="banner-subtext-2">On orders over KSh 2,000 from select sellers</p>
            <a href="{% url 'all-listings' %}?delivery=delivery" class="ad-btn">
                <i class="bi bi-truck"></i>
                <span>Shop with Delivery</span>
            </a>
        </div>
    </div>
</section>

<section class="container category-items-section">
    {% for category in categories|slice:":24" %}
    {% with category_listings=category.listing_set.all|slice:":34" %}
    {% if category_listings %}
    <div class="category-block">
        <div class="category-header">
            <div class="category-title">
                <div class="category-title-icon" style="--category-color: var(--category-{{ forloop.counter0|mod:10 }}-color); --category-shadow: var(--category-{{ forloop.counter0|mod:10 }}-shadow);">
                    <i class="bi bi-{{ category.icon|default:'grid' }}"></i>
                </div>
                <span>{{ category.name }}</span>
            </div>
            <a href="{% url 'all-listings' %}?category={{ category.id }}" class="view-all-btn">
                <span>View All</span>
                <i class="bi bi-arrow-right"></i>
            </a>
        </div>
        
        <div class="items-grid">
            {% for listing in category_listings %}
            <div class="item-card">
                <div class="item-image-container">
                    <img src="{{ listing.get_image_url }}" class="item-image" alt="{{ listing.title }}">
                    <span class="item-badge" style="--category-color: var(--category-{{ forloop.parentloop.counter0|mod:10 }}-color)">{{ category.name }}</span>
                    
                    <button type="button" class="item-favorite-btn like-btn {% if listing.id in user_favorites %}favorited{% endif %}" 
                            data-listing-id="{{ listing.id }}">
                        <i class="bi bi-heart{% if listing.id in user_favorites %}-fill{% endif %}"></i>
                    </button>
                </div>
                <div class="item-content">
                    <h3 class="item-title">{{ listing.title }}</h3>
                    <div class="item-price">KSh {{ listing.price|intcomma }}</div>
                    <div class="item-meta">
                        <span class="item-location">{{ listing.get_location_display }}</span>
                        <span class="item-stock {% if listing.stock > 10 %}in-stock{% elif listing.stock > 0 %}low-stock{% else %}out-of-stock{% endif %}">
                            {% if listing.stock > 10 %}
                                In Stock
                            {% elif listing.stock > 0 %}
                                Low Stock
                            {% else %}
                                Out of Stock
                            {% endif %}
                        </span>
                    </div>
                    <div class="item-actions">
                        <a href="{% url 'listing-detail' listing.pk %}" class="action-btn view-btn">
                            <i class="bi bi-eye"></i>
                            <span>View</span>
                        </a>
                        {% if user.is_authenticated and listing.stock > 0 and listing.seller != user %}
                        <form action="{% url 'add_to_cart' listing.id %}" method="post" class="d-inline">
                            {% csrf_token %}
                            <button type="submit" class="action-btn cart-btn">
                                <i class="bi bi-cart-plus"></i>
                                <span>Cart</span>
                            </button>
                        </form>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
    {% endwith %}
    {% endfor %}
</section>

<section class="container">
    <div class="ad-banner banner-3">
        <div class="ad-content">
            <h2 class="ad-title" id="banner-text-3">Become a Top Seller</h2>
            <p class="ad-text" id="banner-subtext-3">Join thousands of successful sellers on our platform</p>
            <a href="{% url 'listing-create' %}" class="ad-btn">
                <i class="bi bi-rocket"></i>
                <span>Start Selling</span>
            </a>
        </div>
    </div>
</section>


<section class="container sellers-section">
    <div class="section-header">
        <h2 class="section-title">Top Rated Sellers</h2>
        <p class="section-subtitle">Shop from our most trusted and highly-rated sellers</p>
    </div>
    
    <div class="sellers-grid">
        {% for seller in featured_users|slice:":3" %}
        <div class="seller-card">
            <img src="{% if seller.profile_picture %}{{ seller.profile_picture.url }}{% else %}{% static 'images/default_profile_pic.jpg' %}{% endif %}" 
                 class="seller-avatar" alt="{{ seller.username }}"
                 onerror="this.src='{% static 'images/default_profile_pic.jpg' %}'">
            <h3 class="seller-name">{{ seller.username }}</h3>
            <div class="seller-rating">
                <i class="bi bi-star-fill"></i>
                <i class="bi bi-star-fill"></i>
                <i class="bi bi-star-fill"></i>
                <i class="bi bi-star-fill"></i>
                <i class="bi bi-star-half"></i>
                <span>{{ seller.seller_ratings }}</span>
            </div>
            <div class="seller-stats">
                <div class="seller-stat">
                    <div class="seller-stat-value">{{ seller.orders_received.count|default:0 }}</div>
                    <div class="seller-stat-label">Sales</div>
                </div>
                <div class="seller-stat">
                    <div class="seller-stat-value">{{ seller.listings.count }}</div>
                    <div class="seller-stat-label">Items</div>
                </div>
                <div class="seller-stat">
                    <div class="seller-stat-value">98%</div>
                    <div class="seller-stat-label">Rating</div>
                </div>
            </div>
            <a href="{% url 'profile' seller.pk %}" class="seller-btn">Visit Store</a>
        </div>
        {% empty %}
        <div class="seller-card">
            <img src="{% static 'images/default_profile_pic.jpg' %}" class="seller-avatar" alt="Seller 1">
            <h3 class="seller-name">John Mwangi</h3>
            <div class="seller-rating">
                <i class="bi bi-star-fill"></i>
                <i class="bi bi-star-fill"></i>
                <i class="bi bi-star-fill"></i>
                <i class="bi bi-star-fill"></i>
                <i class="bi bi-star-half"></i>
                <span>4.5</span>
            </div>
            <div class="seller-stats">
                <div class="seller-stat">
                    <div class="seller-stat-value">156</div>
                    <div class="seller-stat-label">Sales</div>
                </div>
                <div class="seller-stat">
                    <div class="seller-stat-value">42</div>
                    <div class="seller-stat-label">Items</div>
                </div>
                <div class="seller-stat">
                    <div class="seller-stat-value">98%</div>
                    <div class="seller-stat-label">Rating</div>
                </div>
            </div>
            <a href="#" class="seller-btn">Visit Store</a>
        </div>
        {% endfor %}
    </div>
</section>

<section class="container blog-section">
    <div class="section-header">
        <h2 class="section-title">Latest From Our Blog</h2>
        <p class="section-subtitle">Tips, guides, and news for buyers and sellers</p>
    </div>
    
    <div class="blog-grid">
        {% for post in blog_posts|slice:":3" %}
        <div class="blog-card">
            {% if post.image %}
            <img src="{{ post.image.url }}" class="blog-image" alt="{{ post.title }}">
            {% else %}
            <img src="https://images.unsplash.com/photo-1486312338219-ce68d2c6f44d?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80" class="blog-image" alt="{{ post.title }}">
            {% endif %}
            <div class="blog-content">
                <div class="blog-meta">
                    <span>{{ post.created_at|date:"M d, Y" }}</span>
                    <span>{{ post.author.username }}</span>
                </div>
                <h3 class="blog-title">{{ post.title }}</h3>
                <p class="blog-excerpt">{{ post.excerpt|default:post.content|truncatewords:20 }}</p>
                <a href="{% url 'blog:post-detail' post.slug %}" class="blog-btn">Read More</a>
            </div>
        </div>
        {% empty %}
        <div class="blog-card">
            <img src="https://images.unsplash.com/photo-1486312338219-ce68d2c6f44d?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80" class="blog-image" alt="Blog post">
            <div class="blog-content">
                <div class="blog-meta">
                    <span>Mar 15, 2024</span>
                    <span>Admin</span>
                </div>
                <h3 class="blog-title">How to Sell Your Items Faster</h3>
                <p class="blog-excerpt">Learn the best practices for creating attractive listings and pricing your items competitively.</p>
                <a href="#" class="blog-btn">Read More</a>
            </div>
        </div>
        {% endfor %}
    </div>
</section>

<section class="container faq-section">
    <div class="section-header">
        <h2 class="section-title">Frequently Asked Questions</h2>
        <p class="section-subtitle">Get answers to common questions about buying and selling on Souq</p>
    </div>
    
    <div class="faq-container">
        <div class="faq-item">
            <div class="faq-question">
                <span>How do I create a listing to sell items?</span>
                <i class="bi bi-chevron-down faq-icon"></i>
            </div>
            <div class="faq-answer">
                <p>Creating a listing is easy! Click on "Sell Item" in the navigation, fill in your item details including title, description, price, category, and upload clear photos. Once submitted, your listing will be visible to thousands of potential buyers.</p>
            </div>
        </div>
        
        <div class="faq-item">
            <div class="faq-question">
                <span>Is it safe to buy from sellers on Souq?</span>
                <i class="bi bi-chevron-down faq-icon"></i>
            </div>
            <div class="faq-answer">
                <p>Yes! We have several safety measures in place including seller ratings and reviews, secure messaging system, and escrow protection for payments. Always check seller ratings and communicate through our platform for the safest experience.</p>
            </div>
        </div>
        
        <div class="faq-item">
            <div class="faq-question">
                <span>What payment methods are accepted?</span>
                <i class="bi bi-chevron-down faq-icon"></i>
            </div>
            <div class="faq-answer">
                <p>We support multiple payment methods including M-Pesa, bank transfers, and cash on delivery for certain items. Our escrow system ensures your payment is protected until you receive your item.</p>
            </div>
        </div>
        
        <div class="faq-item">
            <div class="faq-question">
                <span>How does the delivery process work?</span>
                <i class="bi bi-chevron-down faq-icon"></i>
            </div>
            <div class="faq-answer">
                <p>Delivery options vary by seller. Some offer free delivery, while others may charge a fee. You can arrange meetups in safe public locations or choose delivery options during checkout. Always check the seller's delivery preferences before purchasing.</p>
            </div>
        </div>
        
        <div class="faq-item">
            <div class="faq-question">
                <span>Can I return an item if I'm not satisfied?</span>
                <i class="bi bi-chevron-down faq-icon"></i>
            </div>
            <div class="faq-answer">
                <p>Return policies vary by seller. Many sellers offer returns within a specified period if the item is not as described. Check the individual seller's return policy and contact them directly if you have issues with your purchase.</p>
            </div>
        </div>
        
        <div class="faq-item">
            <div class="faq-question">
                <span>How do I contact a seller?</span>
                <i class="bi bi-chevron-down faq-icon"></i>
            </div>
            <div class="faq-answer">
                <p>You can contact sellers through our secure messaging system. Visit the seller's profile or listing page and click the "Message Seller" button. This keeps your communication safe and documented within our platform.</p>
            </div>
        </div>
    </div>
</section>

<section class="container cta-section">
    <div class="cta-content">
        <h2>Ready to Get Started?</h2>
        <p>Join thousands of satisfied buyers and sellers in our vibrant marketplace community.</p>
        <div class="cta-buttons">
            {% if user.is_authenticated %}
            <a href="{% url 'listing-create' %}" class="cta-btn cta-btn-primary">
                <i class="bi bi-plus-circle"></i>
                <span>Start Selling</span>
            </a>
            <a href="{% url 'all-listings' %}" class="cta-btn cta-btn-secondary">
                <i class="bi bi-grid"></i>
                <span>Browse Listings</span>
            </a>
            {% else %}
            <a href="{% url 'register' %}" class="cta-btn cta-btn-primary">
                <i class="bi bi-person-plus"></i>
                <span>Create Account</span>
            </a>
            <a href="{% url 'all-listings' %}" class="cta-btn cta-btn-secondary">
                <i class="bi bi-eye"></i>
                <span>Browse as Guest</span>
            </a>
            {% endif %}
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
// Reusable Like Functionality
function initLikeButtons() {
    document.querySelectorAll('.like-btn').forEach(button => {
        button.addEventListener('click', function(e) {
            e.preventDefault();
            const listingId = this.getAttribute('data-listing-id');
            const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value;
            
            this.style.transform = 'scale(0.9)';
            
            fetch("{% url 'toggle_favorite' 0 %}".replace('0', listingId), {
                method: 'POST',
                headers: {
                    'X-Requested-With': 'XMLHttpRequest',
                    'X-CSRFToken': csrfToken
                }
            })
            .then(response => response.json())
            .then(data => {
                setTimeout(() => {
                    this.style.transform = 'scale(1)';
                }, 150);
                
                if (data.is_favorited) {
                    this.classList.add('favorited');
                    this.querySelector('i').classList.remove('bi-heart');
                    this.querySelector('i').classList.add('bi-heart-fill');
                } else {
                    this.classList.remove('favorited');
                    this.querySelector('i').classList.remove('bi-heart-fill');
                    this.querySelector('i').classList.add('bi-heart');
                }
            })
            .catch(error => console.error('Error:', error));
        });
    });
}

document.addEventListener('DOMContentLoaded', function() {
    // Initialize like buttons
    initLikeButtons();
    
    // Hero Carousel
    const heroSlides = document.querySelectorAll('.carousel-slide');
    const heroDots = document.querySelectorAll('.carousel-dot');
    let currentHeroSlide = 0;
    let heroSlideInterval;
    
    function showHeroSlide(n) {
        heroSlides.forEach(slide => slide.classList.remove('active'));
        heroDots.forEach(dot => dot.classList.remove('active'));
        
        currentHeroSlide = (n + heroSlides.length) % heroSlides.length;
        
        heroSlides[currentHeroSlide].classList.add('active');
        heroDots[currentHeroSlide].classList.add('active');
    }
    
    function nextHeroSlide() {
        showHeroSlide(currentHeroSlide + 1);
    }
    
    heroSlideInterval = setInterval(nextHeroSlide, 6000);
    
    heroDots.forEach((dot, index) => {
        dot.addEventListener('click', () => {
            clearInterval(heroSlideInterval);
            showHeroSlide(index);
            heroSlideInterval = setInterval(nextHeroSlide, 6000);
        });
    });
    
    const heroCarousel = document.querySelector('.hero-carousel');
    heroCarousel.addEventListener('mouseenter', () => {
        clearInterval(heroSlideInterval);
    });
    
    heroCarousel.addEventListener('mouseleave', () => {
        heroSlideInterval = setInterval(nextHeroSlide, 6000);
    });
    
    // Categories Toggle - FIXED: Side-by-side display with animation
    const toggleBtn = document.getElementById('toggle-categories');
    const toggleIcon = document.getElementById('toggle-icon');
    const toggleText = document.getElementById('toggle-text');
    const extraCategoriesContainer = document.getElementById('extra-categories-container');
    let categoriesExpanded = false;
    
    if (toggleBtn) {
        toggleBtn.addEventListener('click', function() {
            categoriesExpanded = !categoriesExpanded;
            
            if (categoriesExpanded) {
                extraCategoriesContainer.classList.add('show');
                toggleIcon.classList.remove('bi-chevron-down');
                toggleIcon.classList.add('bi-chevron-up');
                toggleText.textContent = 'View Less Categories';
                
                setTimeout(() => {
                    document.querySelector('.categories-section').scrollIntoView({ 
                        behavior: 'smooth',
                        block: 'start'
                    });
                }, 300);
            } else {
                extraCategoriesContainer.classList.remove('show');
                toggleIcon.classList.remove('bi-chevron-up');
                toggleIcon.classList.add('bi-chevron-down');
                toggleText.textContent = 'View More Categories';
            }
        });
    }

    // Stats Scroll
    function initStatsScroll() {
        const statsGrid = document.querySelector('.stats-grid');
        if (statsGrid && window.innerWidth < 768) {
            let isDown = false;
            let startX;
            let scrollLeft;

            statsGrid.addEventListener('mousedown', (e) => {
                isDown = true;
                statsGrid.classList.add('active');
                startX = e.pageX - statsGrid.offsetLeft;
                scrollLeft = statsGrid.scrollLeft;
            });

            statsGrid.addEventListener('mouseleave', () => {
                isDown = false;
                statsGrid.classList.remove('active');
            });

            statsGrid.addEventListener('mouseup', () => {
                isDown = false;
                statsGrid.classList.remove('active');
            });

            statsGrid.addEventListener('mousemove', (e) => {
                if (!isDown) return;
                e.preventDefault();
                const x = e.pageX - statsGrid.offsetLeft;
                const walk = (x - startX) * 2;
                statsGrid.scrollLeft = scrollLeft - walk;
            });

            statsGrid.addEventListener('touchstart', (e) => {
                isDown = true;
                startX = e.touches[0].pageX - statsGrid.offsetLeft;
                scrollLeft = statsGrid.scrollLeft;
            });

            statsGrid.addEventListener('touchend', () => {
                isDown = false;
            });

            statsGrid.addEventListener('touchmove', (e) => {
                if (!isDown) return;
                const x = e.touches[0].pageX - statsGrid.offsetLeft;
                const walk = (x - startX) * 2;
                statsGrid.scrollLeft = scrollLeft - walk;
            });
        }
    }

    initStatsScroll();
    window.addEventListener('resize', initStatsScroll);

    // FAQ Accordion
    const faqItems = document.querySelectorAll('.faq-item');
    
    faqItems.forEach(item => {
        const question = item.querySelector('.faq-question');
        
        question.addEventListener('click', () => {
            faqItems.forEach(otherItem => {
                if (otherItem !== item) {
                    otherItem.classList.remove('active');
                }
            });
            
            item.classList.toggle('active');
        });
    });
    
    // Banner Text Cycling - FIXED: Proper text cycling for all banners
    const bannerTexts1 = [
        { title: "Flash Sale! Up to 50% Off", subtitle: "Limited time offers on electronics and home appliances" },
        { title: "Limited Time Offers", subtitle: "Don't miss out on these amazing deals" },
        { title: "Don't Miss Out!", subtitle: "Shop now before these deals are gone" }
    ];
    
    const bannerTexts2 = [
        { title: "Free Delivery Available", subtitle: "On orders over KSh 2,000 from select sellers" },
        { title: "Fast & Reliable Shipping", subtitle: "Get your items delivered quickly and safely" },
        { title: "Convenient Delivery Options", subtitle: "Choose from multiple delivery methods" }
    ];
    
    const bannerTexts3 = [
        { title: "Become a Top Seller", subtitle: "Join thousands of successful sellers on our platform" },
        { title: "Join Successful Sellers", subtitle: "Start earning with our easy-to-use platform" },
        { title: "Grow Your Business", subtitle: "Reach more customers and increase your sales" }
    ];
    
    let currentBannerIndex1 = 0;
    let currentBannerIndex2 = 0;
    let currentBannerIndex3 = 0;
    
    function rotateBannerText(bannerId, subtextId, texts, currentIndex) {
        const bannerElement = document.getElementById(bannerId);
        const subtextElement = document.getElementById(subtextId);
        
        if (!bannerElement || !subtextElement) return;
        
        bannerElement.style.animation = 'textRotate 0.5s ease-out';
        subtextElement.style.animation = 'textRotate 0.5s ease-out';
        
        setTimeout(() => {
            currentIndex = (currentIndex + 1) % texts.length;
            bannerElement.textContent = texts[currentIndex].title;
            subtextElement.textContent = texts[currentIndex].subtitle;
            bannerElement.style.animation = 'textRotate 0.5s ease-out';
            subtextElement.style.animation = 'textRotate 0.5s ease-out';
        }, 250);
        
        setTimeout(() => {
            bannerElement.style.animation = '';
            subtextElement.style.animation = '';
        }, 500);
        
        return currentIndex;
    }
    
    setInterval(() => {
        currentBannerIndex1 = rotateBannerText('banner-text-1', 'banner-subtext-1', bannerTexts1, currentBannerIndex1);
    }, 5000);
    
    setInterval(() => {
        currentBannerIndex2 = rotateBannerText('banner-text-2', 'banner-subtext-2', bannerTexts2, currentBannerIndex2);
    }, 5000);
    
    setInterval(() => {
        currentBannerIndex3 = rotateBannerText('banner-text-3', 'banner-subtext-3', bannerTexts3, currentBannerIndex3);
    }, 5000);
    
    // Cart Button Authentication Check
    document.querySelectorAll('.cart-btn').forEach(btn => {
        btn.addEventListener('click', function(e) {
            if (!this.closest('form')) {
                e.preventDefault();
                if (!{{ user.is_authenticated|yesno:"true,false" }}) {
                    window.location.href = "{% url 'login' %}";
                }
            }
        });
    });
    
    // Scroll Animation
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };
    
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.opacity = '1';
                entry.target.style.transform = 'translateY(0)';
            }
        });
    }, observerOptions);
    
    document.querySelectorAll('.category-card, .item-card, .stat-item, .seller-card, .blog-card, .faq-item').forEach(card => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(30px)';
        card.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
        observer.observe(card);
    });
    
    // Ripple Effect for Buttons
    document.querySelectorAll('.hero-btn, .action-btn, .seller-btn, .blog-btn, .cta-btn, .ad-btn, .toggle-btn').forEach(btn => {
        btn.addEventListener('click', function(e) {
            const ripple = document.createElement('span');
            const rect = this.getBoundingClientRect();
            const size = Math.max(rect.width, rect.height);
            const x = e.clientX - rect.left - size / 2;
            const y = e.clientY - rect.top - size / 2;
            
            ripple.style.width = ripple.style.height = size + 'px';
            ripple.style.left = x + 'px';
            ripple.style.top = y + 'px';
            ripple.classList.add('ripple');
            
            this.appendChild(ripple);
            
            setTimeout(() => {
                ripple.remove();
            }, 600);
        });
    });
    
    // Add Ripple CSS
    const style = document.createElement('style');
    style.textContent = `
        .ripple {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.6);
            transform: scale(0);
            animation: ripple-animation 0.6s linear;
        }
        
        @keyframes ripple-animation {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }
        
        .hero-btn, .action-btn, .seller-btn, .blog-btn, .cta-btn, .ad-btn, .toggle-btn {
            position: relative;
            overflow: hidden;
        }
        
        @keyframes textRotate {
            0% { opacity: 0; transform: translateY(20px); }
            20% { opacity: 1; transform: translateY(0); }
            80% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(-20px); }
        }
    `;
    document.head.appendChild(style);
});
</script>
{% endblock %}